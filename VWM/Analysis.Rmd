---
title: "Visual Working Memory Analysis"
author: "Jason Locklin <jalockli@uwaterloo.ca>"
date: "12/1/2014"
output:
  html_document:
    fig_caption: yes
    keep_md: yes
    toc: yes
---

This is an R Markdown document generated in R Studio. Markdown is a simple 
formatting syntax for authoring HTML, PDF, and MS Word documents. For more 
details on using R Markdown see <http://rmarkdown.rstudio.com>.

### Data Import and Formating

The data file I recieved is a complicated excel file with lots of information. I
reduced it to a simple table manually and saved to a csv file for reading into 
R. 

```{r}
library(reshape2) #For "Tidying" data into useful format
library(plyr)     #For transforming data before plots and analysis
library(ggplot2)  #For producing figures
vwm <- read.csv("Data/vwm_data.csv", 
                colClasses=c("factor","factor", rep("numeric", 12)))
```


The data needs to be tidied to a convenient format (see Wickham, 2014).

```{r}
d <- melt(vwm, id.vars=c("Subj_Group", "Subj_ID"))
d = data.frame(c(d[1:2], colsplit(d$variable, "_item[s]?.", c("Number_of_Items","variable")), d[4]))
head(d)
```


A quick summary of the data for each group.
```{r}
acast(d, Subj_Group ~ variable ~ Number_of_Items , fun=mean)
```

#### What it looks like:

1. Looking at precision, Patients generally do worse than Older Controls, who
generally do worse than Young adults. Each group generally does worse as more 
targets are added.

2. pTarget: Patents are averaging lower probabilities of selecting the target 
color even in the case of no distractors. Distractors may be effective in the 
healthy groups, but they do quite well.

3. The healthy groups seem to rarely select a distractor color, and seem to be 
guessing when they get it wrong. The Patients might be selecting distractor 
colors as often as they guess, indicating a possible lack of binding color to 
spatial location.

### Research Questions:

1. Are the patients able to encode and recall colour? 
2. Is there a deficit of colour WM?
3. Are the patients able to bind/recall location and colour of two targets?
4. What about 3?
5. Again, is there a deficit of this binding?
6. Are the patients mis-binding color/location in the 2/3 condition? or are they
   forgetting the stimuli entirely? (i.e., guessing or NonTarget selection).
   

### Are the patients able to encode and recall colour? 

Just looking at the "one target" case, were patients able to reliably report the
colour of the target.


Create summary data:
```{r}
simple <- d[d$variable == "precision" & d$Number_of_Items =="one",]

cdata <- ddply(simple, c("Subj_Group", "variable"), summarise,
               N    = length(value),
               Mean = mean(value),
               sd   = sd(value),
               se   = sd / sqrt(N) )
head(cdata)
```



Create a plot of means, and a seperate point plot to see outliers:
```{r }
p <- ggplot(cdata, aes(x = Subj_Group, y = Mean)) 
p + geom_bar(stat = "identity", width=0.5) +
    geom_errorbar(aes(ymin=Mean-se, ymax=Mean+se), width=.2) + 
    xlab("") +
    ylab("Precision (SE)") + 
    ggtitle("Response Precision for Single Target Condition") +
    scale_y_continuous(breaks=0:20*4) +
    theme_gray()

ggplot(simple, aes(x = Subj_Group, y = value))  + geom_jitter(position = position_jitter(width = .1))
```

Both older groups seem to have a single extreme case, and in both cases, that 
point will drastically increase the mean precision of the group. However, 
removing those two points would not make the Patient group unique. At best, it 
would make the two older groups different from the Young Adults (they would be
less precise). There is no point in further analysis of this point as I'm not
concerned with differences due only to aging.


Perform an ANOVA anyway:
```{r}
fit <- aov(value ~ Subj_Group, data=simple) 
layout(matrix(c(1,2,3,4),2,2)) # optional layout
plot(fit) # diagnostic plots
```

Anova table:
```{r}
summary(fit)
TukeyHSD(fit)
```


#### Looking at probability of target selection, a derivative of precision.





#### Is there a deficit of colour WM?

### Are the patients able to bind/recall location and colour of two targets?

#### What about 3?

#### Again, is there a deficit of this binding?

### Are the patients mis-binding color/location in the 2/3 condition? or are they
   forgetting the stimuli entirely? (i.e., guessing or NonTarget selection).




